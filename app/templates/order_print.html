<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>Wydruk Zlecenia {{ order.order_code }}</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script>
        window.onload = function() {
            window.print();
        }
    </script>
    <style>
        @media print {
            body { 
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            .no-print { display: none; }
        }
        body {
            font-size: 11pt;
        }
        h1, h2, h3, h4 {
            margin-top: 1.5rem;
            margin-bottom: 1rem;
        }
        table {
            font-size: 10pt;
        }
    </style>
</head>
<body>
    <div class="container mt-4">
        <h1 class="text-center">Zlecenie Produkcyjne: {{ order.order_code }}</h1>
        
        <div class="card mt-4">
            <div class="card-body">
                <h4 class="card-title">Informacje o zleceniu</h4>
                <p><strong>Klient:</strong> {{ order.client.name }}</p>
                <p><strong>Termin realizacji:</strong> {{ order.deadline.strftime('%Y-%m-%d') }}</p>
                <p><strong>Zlecający:</strong> {{ order.zlecajacy }}</p>
            </div>
        </div>

        <h4 class="mt-4">Tkaniny</h4>
        <ul>
            {% for order_fabric in order.fabrics %}
                <li>{{ order_fabric.fabric.name }}</li>
            {% else %}
                <li>Brak przypisanych tkanin.</li>
            {% endfor %}
        </ul>
        <h4 class="mt-4">Opis zlecenia</h4>
        <p>{{ order.description | nl2br }}</p>

        {% if order.login_info %}
            <h4 class="mt-4">Informacje do logowania</h4>
            <p>{{ order.login_info | nl2br }}</p>
        {% endif %}

        <h4 class="mt-4">Zamówione produkty</h4>
        <table class="table table-bordered table-sm">
            <thead class="thead-light">
                <tr>
                    <th>Produkt</th>
                    <th>Rozmiar</th>
                    <th>Ilość</th>
                </tr>
            </thead>
            <tbody>
                {% for item in order.order_items %}
                <tr>
                    <td>{{ item.product.name }}</td>
                    <td>{{ item.size }}</td>
                    <td>{{ item.quantity }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>

        {% if material_summary %}
            <h4 class="mt-4">Planowane zużycie materiałów</h4>
            <table class="table table-bordered table-sm">
                <thead class="thead-light">
                    <tr>
                        <th>Materiał</th>
                        <th>Ilość</th>
                    </tr>
                </thead>
                <tbody>
                    {% for material in material_summary %}
                    <tr>
                        <td>{{ material.name }}</td>
                        <td>{{ material.quantity }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        {% endif %}
    </div>
</body>
</html>